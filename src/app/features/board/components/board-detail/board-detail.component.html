<div class="board-detail-container" *ngIf="boardStore.selectedBoard() as board">
  <header class="board-header">
    <div class="board-header-title">
      <h1>{{ board.title }}</h1>
      <p *ngIf="board.description" class="board-description">{{ board.description }}</p>
    </div>

    <div class="board-actions">
      <app-ui-button variant="secondary" size="sm" (buttonClick)="openBoardSettings()">
        <app-ui-icon name="settings"></app-ui-icon>
        Settings
      </app-ui-button>
    </div>
  </header>

  <div class="board-content">
    <div class="columns-container">
      <ng-container *ngIf="columnStore.isLoading(); else columnsContent">
        <div class="loading-state">
          <p>Loading columns...</p>
        </div>
      </ng-container>

      <ng-template #columnsContent>
        <div class="columns-wrapper" cdkDropListGroup>
          <div *ngFor="let column of columnStore.columnsByBoard()" class="column-wrapper">
            <app-column
              [column]="column"
              [tasks]="taskStore.tasksByColumn()[column.id] || []"
              [dropListIds]="getDropListIds()"
            ></app-column>
          </div>

          <div class="add-column-wrapper">
            <app-ui-card [padding]="'medium'" [bordered]="true" class="add-column-card">
              <div *ngIf="!showAddColumn; else addColumnForm" class="add-column-placeholder">
                <app-ui-button variant="text" (buttonClick)="showAddColumn = true">
                  <app-ui-icon name="plus"></app-ui-icon>
                  Add Column
                </app-ui-button>
              </div>

              <ng-template #addColumnForm>
                <div class="add-column-form">
                  <app-ui-input
                    label="Column Title"
                    [(ngModel)]="newColumnTitle"
                    placeholder="Enter column title"
                    [required]="true"
                  ></app-ui-input>

                  <div class="form-actions">
                    <app-ui-button variant="text" (buttonClick)="cancelAddColumn()"
                      >Cancel</app-ui-button
                    >
                    <app-ui-button [disabled]="!newColumnTitle.trim()" (buttonClick)="addColumn()">
                      Add Column
                    </app-ui-button>
                  </div>
                </div>
              </ng-template>
            </app-ui-card>
          </div>
        </div>
      </ng-template>
    </div>
  </div>
</div>

<div class="board-not-found" *ngIf="!boardStore.selectedBoard() && !boardStore.isLoading()">
  <app-ui-card>
    <h2>Board not found</h2>
    <p>The board you're looking for doesn't exist or you don't have access to it.</p>
    <app-ui-button [routerLink]="['/boards']">Go to Boards</app-ui-button>
  </app-ui-card>
</div>
